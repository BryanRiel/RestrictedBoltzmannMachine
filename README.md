# Overview
This C++ code implements two forms of the Restricted Boltzmann Machine for use in collaborative filtering, mainly predicting Netflix movie ratings given 100 million prior ratings. The code was developed during my participation in Caltech's CS156b "Learning From Data" course. The primary purpose of this repository is to share this implementation as a reference which can be adapted for other large datasets. For the purposes of movie predictions, we found that while RBMs weren't competitive with the best standalone models, they provided predictions that blended well with other factorization-based methods.

While many developers new to RBMs are likely to turn to deep learning frameworks like Theano or Tensorflow (which weren't mature at the time this code was originally developed), I still think this implementation is useful both from a learning point of view (nothing drills concepts into your head like debugging seg faults for days on end) as well as for training (from a data perspective). RBMs are typically trained using some form of contrastive divergence (CD) to estimate the gradient, which is a bit of an opaque concept that can lead to poor training if done incorrectly. I found that implementing these steps manually helped my understanding of CD and led to finer control for the stochastic gradient descent with/without regularization.

# Compilation and running the code
With that said, this code won't run out of the box since we had to delete the Netflix data we trained on as part of the course requirements. However, the code should build fine once the Makefile is modified to your environment. The current paths in the Makefile are for Mac OS with Macports.

The sources `Matrix.h` and `Matrix.cpp` contain a simple matrix class with a GSL backend (which itself uses a CBLAS backend) for random number generation and matrix multiplication. `RBM.cpp` contains the standard RBM while `RBMcond.cpp` implements the conditional RBM (see https://www.cs.toronto.edu/~vmnih/docs/uai_crbms.pdf). The `train.cpp` and `train_cond.cpp` files train the RBM and conditional RBM, respectively, on training movie ratings. The final states of the RBM hidden units are saved to disk during training using HDF5. These states are then used to predict movie ratings on test data using `predict.cpp` and `predict_cond.cpp`.
